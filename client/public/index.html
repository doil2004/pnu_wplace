<!DOCTYPE html>
<html lang="ko">
  <head>
    <title>PNU-WPLACE</title>
    <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    
    <link rel="stylesheet" href="./styles.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script src="../src/main.js"></script>
    <script src="../src/test.js"></script> <!-- 격자 확인용으로 넣어본 부분 -->
    <script src="../src/ui/pixel.js"></script>
    <script src="../src/ui/color-picker.js"></script>
  </head>
  <body>
    
    <div id="map"></div>
    
    <div id="color-picker">
      <span>색 선택:</span>
    </div>
    

    <script>
      // 부산대 영역
      const pnuBounds = L.latLngBounds(
        [35.227, 129.077], // 남서
        [35.237, 129.092]  // 북동
      );

      // 지도 생성
      const map = L.map('map', {
        center: [35.232, 129.084],
        zoom: 16,
        minZoom: 15,
        maxZoom: 19,
        maxBounds: pnuBounds,
        maxBoundsViscosity: 1.0
      });

      // 기본 타일 레이어
      L.tileLayer(
        'https://{s}.basemaps.cartocdn.com/rastertiles/light_all/{z}/{x}/{y}.png',
        {
          attribution: '&copy; OpenStreetMap, &copy; CARTO',
          subdomains: 'abcd',
          maxZoom: 20
        }
      ).addTo(map);
      
      const COLORS = [
        '#ff3b30', // 빨강
        '#ff9500', // 주황
        '#ffcc00', // 노랑
        '#34c759', // 초록
        '#007aff', // 파랑
        '#5856d6', // 남보라
        '#af52de', // 보라
      ];
      
      const colorPicker = new ColorPicker("color-picker", COLORS);

      map.whenReady(() => {
        console.log('[Debug] map ready, adding layers');

        // 격자 확인용.
        const debugLayer = new DebugGridLayer();
        debugLayer.addTo(map).bringToFront();

        const pixelLayer = new PixelGridLayer();
        pixelLayer.addTo(map).bringToFront();

        map.on('click', (e) => {
          pixelLayer.paintPixelAt(e.latlng, colorPicker.currentColor);
        });
      });

    </script>
  </body>
</html>